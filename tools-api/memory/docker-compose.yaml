# Standalone Memory API + Qdrant
# Use this for development/testing memory service in isolation

services:
  qdrant:
    image: qdrant/qdrant:latest
    container_name: qdrant
    environment:
      - QDRANT__LOG_LEVEL=DEBUG
    ports:
      - "5100:5100" # Dashboard UI
      - "6333:6333" # HTTP API
    volumes:
      - C:/docker-data/qdrant/storage:/qdrant/storage
    restart: unless-stopped
    networks:
      - webtools_network

  memory_api:
    build:
      context: ..
      dockerfile: memory/Dockerfile
    container_name: memory_api
    environment:
      - QDRANT_HOST=qdrant
      - QDRANT_PORT=6333
      - INDEX_NAME=user_memory_collection
      - EMBEDDING_PROVIDER=sentence_transformers
      - SUMMARY_MODEL=sshleifer/distilbart-cnn-12-6
      - SUMMARY_DEVICE=cpu # Use cpu for summarizer (or 0 for GPU)
      - HF_HOME=/models
    volumes:
      - C:/docker-data/models:/models
    ports:
      - "8000:8000"
    depends_on:
      - qdrant
    restart: unless-stopped
    networks:
      - webtools_network

networks:
  webtools_network:
    external: true
